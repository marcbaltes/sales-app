//Copyright Patrick Roebuck roebuck@v-page.com www.v-page.com
//Modified by Lisa Hickling lisa.h@pointclickcare.com

var newWindow
var newWindowSimple
var helpWindow 
var helpWindowSimple
//var strProjectFramesPagePlus = "/help/online/PCC_OnLine_Help.htm";
var strProjectFramesPagePlus = "/help/online/NewPCCHelp.htm";
var strProjectPath
var strHelpPage
var isNav4 = (navigator.appName == "Netscape" && parseInt(navigator.appVersion) == 4);

var orgW = self.clientWidth;
var orgH = self.clientHeight;
var orgT = self.clientTop;
var orgL = self.clientLeft;
var strTriHelpWindowOptions

function callHelp(strProjectPath)
{
	var strTriHelpWindowOptions = ",toolbar=yes";//defines whether to display the toolbar (yes) or hides it (no)
	strTriHelpWindowOptions += ",top=0";//40//defines the distance from the top of the screen that the browser window is opened
	strTriHelpWindowOptions += ",left=100";
	
	strTriHelpWindowOptions += ",width=800"
        strTriHelpWindowOptions += ",resizable=1"
	strTriHelpWindowOptions += ",height=500"
	
	
	helpWindow = window.open("", newWindow, strTriHelpWindowOptions);
	
	if(strProjectPath==strProjectFramesPagePlus)
	   strProjectPath="";
	else
		strProjectPath = "#"+strProjectPath;
	
	helpWindow.location.href = strProjectFramesPagePlus +strProjectPath ;
	helpWindow.focus();
	
}

function callHelpOld(strProjectPath,strHelpPage){
	
	var width = screen.width;
	var height = screen.height;
	
	var screenPer;
	if(width<=800)
		screenPer = 0.5;
	else
		screenPer = 0.7;
	
	var popUpSize = 1-screenPer;
	
	var strTriHelpWindowOptions = ",toolbar=yes";//defines whether to display the toolbar (yes) or hides it (no)
	strTriHelpWindowOptions += ",top=0";//40//defines the distance from the top of the screen that the browser window is opened
	strTriHelpWindowOptions += ",left="+width*screenPer;//800//defines the distance from the left of the screen that the browser window is opened
	
	strTriHelpWindowOptions += ",width="+width*popUpSize;//475 //defines the width of the browser window
	strTriHelpWindowOptions += ",height="+screen.height;//905 //defines the height of the browser window
	
	
	self.resizeTo(width*screenPer,screen.height);
	//self.resizeTo(800,1000);
	
	self.moveTo(0,0);
	
	if (isNav4){helpWindow = window.open("", newWindow, strTriHelpWindowOptions);
	if (helpWindowSimple && !helpWindowSimple.closed){helpWindowSimple.close();}
	helpWindow.close();
	helpWindow = window.open("", newWindow, strTriHelpWindowOptions);
	helpWindow.location.href = strProjectPath + strProjectFramesPagePlus + strHelpPage;
	helpWindow.focus();
	}
	else if (helpWindow == null || helpWindow.closed){
	if (helpWindowSimple && !helpWindowSimple.closed){helpWindowSimple.close();}
	helpWindow = window.open("", newWindow, strTriHelpWindowOptions);
	helpWindow.location.href = strProjectPath + strProjectFramesPagePlus + strHelpPage;
	}
	else if (helpWindow && !helpWindow.closed){
	if (helpWindowSimple && !helpWindowSimple.closed){helpWindowSimple.close();}
	helpWindow.bsscright.location.href = strProjectPath + strHelpPage;
	helpWindow.focus();
	}
}



function callHelpSimple(strProjectPath,strHelpPage){
	var strSingleHelpWindowOptions = ",toolbar=no";//defines whether to display the toolbar (yes) or hides it (no)
	strSingleHelpWindowOptions += ",top=40";//defines the distance from the top of the screen that the browser window is opened
	strSingleHelpWindowOptions += ",left=225";//defines the distance from the left of the screen that the browser window is opened
	strSingleHelpWindowOptions += ",width=550";//defines the width of the browser window
	strSingleHelpWindowOptions += ",height=500";//defines the height of the browser window
	if (isNav4){helpWindowSimple = window.open("", newWindowSimple, strSingleHelpWindowOptions);
	if (helpWindow && !helpWindow.closed){helpWindow.close();}
	helpWindowSimple.close();
	helpWindowSimple = window.open("", newWindowSimple, strSingleHelpWindowOptions);
	helpWindowSimple.location.href = strProjectPath + strHelpPage;
	helpWindowSimple.focus();
	}
	else if (helpWindowSimple == null || helpWindowSimple.closed){
	if (helpWindow && !helpWindow.closed){helpWindow.close();}
	helpWindowSimple = window.open("", newWindowSimple, strSingleHelpWindowOptions);
	helpWindowSimple.location.href = strProjectPath  + strHelpPage;
	}
	else if (helpWindowSimple && !helpWindowSimple.closed){
	if (helpWindow && !helpWindow.closed){helpWindow.close();}
	helpWindowSimple.parent.location.href = strProjectPath + strHelpPage;
	helpWindowSimple.focus();
	}
}


function resetClient(){
	helpWindow.opener.resizeTo(orgW, orgH);
	helpWindow.opener.MoveTo(orgL, orgT);
}
